---
title: "Helpdesk responses"
author: "Ward Langeraert"
date: "`r Sys.Date()`"
output: html_document
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r, message=FALSE}
library(tidyverse)
library(INBOtheme)
library(googlesheets4)

conflicted::conflicts_prefer(dplyr::filter)
```

# Tijdsreeks

```{r, message=FALSE}
# Get years
current_year <- year(Sys.Date())
prev_year <- current_year - 1

# Load data
responses_raw <- read_sheet(
  paste0("https://docs.google.com/spreadsheets/d/",
         "19ERZjnsKgxmJ0gyU9GH2i1nAjbsIdDCxougTxqNPJco/edit?usp=sharing")
  )

# Prepare data
data <- responses_raw %>%
  mutate(jaar = year(Timestamp),
         datum = date(Timestamp)) %>%
  arrange(Timestamp) %>%
  mutate(one = 1,
         cum_n = cumsum(one),
         .by = "jaar") %>%
  filter(jaar < current_year)
```

```{r}
ggplot(data) +
  geom_bar(aes(x = jaar)) +
  labs(y = "Aantal BMK helpdesk aanvragen")
```

# Analyse vorig jaar

```{r}
data %>%
  filter(jaar == prev_year) %>%
  ggplot(aes(x = datum, y = cum_n)) +
    geom_line() +
    geom_point() +
    labs(y = "Cumulatief aantal BMK\nhelpdesk aanvragen", title = prev_year)
```
